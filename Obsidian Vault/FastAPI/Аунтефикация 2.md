```python
from fastapi import FastAPI, Cookie, Response, HTTPException

from pydantic import BaseModel

import itsdangerous

import uuid

  

app = FastAPI()

  

users = {

    "username":"misha228",

    "password":"123456789"

}

  

SECRET_KEY = "very_dump_lower"

serializer = itsdangerous.URLSafeSerializer(secret_key=SECRET_KEY)

  

class UserLogin(BaseModel):

    username: str

    password : str

  
  

@app.post("/login")

def login_user(user : UserLogin, response: Response):

    if users["username"] == user.username and users["password"] == user.password:

        user_id = str(uuid.uuid4())

        signature = serializer.dumps(user_id)

        token = f"{user_id}.{signature}"

        response.set_cookie(key="session_token", value=token, max_age=1200, httponly=True)

        return {"session_token":token, "user_id":user_id, "signature":signature}

    else:

        return {"message":"Error, Неверный логин или пароль"}

  

@app.get("/user")

def login(session_token = Cookie(default=None)):

    if not session_token:

        raise  HTTPException(status_code=401, detail="Unauthorizated")

    user_id, signature = session_token.split('.',1)

    try:

        exected_user_id = serializer.loads(signature)

        if exected_user_id != user_id:

            raise HTTPException(status_code=401, detail="Куки не валидны")

    except:

        return {"error": "Invalid or tampered cookie"}

    return users

  

@app.get("/logout")

def logout(response : Response):

    response.delete_cookie("session_token")

    return {"message":"good"}
```